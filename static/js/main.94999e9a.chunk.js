(this.webpackJsonptnt_fu=this.webpackJsonptnt_fu||[]).push([[0],{111:function(t,e,a){},112:function(t,e,a){},125:function(t,e,a){"use strict";a.r(e),a.d(e,"history",(function(){return b}));var n=a(0),s=a.n(n),o=a(51),r=a.n(o),i=a(1),c=a(23);const d=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(111),a(112);const l=a(49);var u=a(113),h=a(114);a(119);class p extends n.Component{constructor(t){super(t);const e=h.parse(this.props.location.search,{ignoreQueryPrefix:!0});this.surveyUrl=e.survey_url,this.state={encryptedMetadata:e.id,sendingData:!1,link:void 0},u.isUndefined(this.state.encryptedMetadata)||this.addScript("/tnt_fu/external/lab.js",()=>{this.addScript("/tnt_fu/script.js")})}packageDataForExport(t){const e={};return e.encrypted_metadata=this.state.encryptedMetadata,e.taskName=l.taskName,e.taskVersion=l.taskVersion,e.data=this.processLabJsData(t),JSON.stringify(e)}processLabJsData(t){const e=[];return e.push(t[0]),e.push(),e}componentDidMount(){var t=this;window.addEventListener("message",(function(e){if("labjs.data"===e.data.type){const a=JSON.parse(e.data.json);if((l.debug||d)&&(console.log(a),console.log(t.processLabJsData(a))),d)return void(t.surveyUrl&&t.setState({link:t.surveyUrl}));t.setState({sendingData:!0}),Object(c.b)(t.state.encryptedMetadata,t.packageDataForExport(a)).then(()=>{t.surveyUrl?t.setState({link:t.surveyUrl}):Object(c.a)(t.state.encryptedMetadata).then(e=>t.setState({link:e}))})}}))}addScript(t,e){const a=document.createElement("script");a.src=t,a.type="module",a.onreadystatechange=e,a.onload=e,document.head.appendChild(a)}render(){return u.isUndefined(this.state.encryptedMetadata)?s.a.createElement("div",null,s.a.createElement("h2",null,"Something went wrong. Please try again.")):(u.isUndefined(this.state.link)||window.location.assign(this.state.link),s.a.createElement("div",null,s.a.createElement("div",{className:"container fullscreen","data-labjs-section":"main",style:{visibility:this.state.sendingData?"hidden":"visible"}},s.a.createElement("main",{className:"content-vertical-center content-horizontal-center"},s.a.createElement("div",null,s.a.createElement("h2",null,"Loading Experiment"),s.a.createElement("p",null,"The experiment is loading and should start in a few seconds")))),s.a.createElement("div",{className:"center",style:{visibility:this.state.sendingData?"visible":"hidden"}},s.a.createElement("h2",null,"Saving data... do not exit window"))))}}var m=p,f=()=>s.a.createElement(i.c,null,s.a.createElement(i.a,{path:"/",exact:!0,component:m}));class g extends n.Component{render(){return s.a.createElement("div",null,s.a.createElement(f,null))}}var w=g,y=a(22),v=a(3);const b=Object(v.a)();r.a.render(s.a.createElement(y.a,{history:b,basename:"/tnt_fu"},s.a.createElement(w,null)),document.getElementById("root"))},23:function(t,e,a){"use strict";(function(t){a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return i}));var n=a(61),s=a(108);const o=a(49);function r(e,a){return new Promise((function(r,i){const c=s.stringify({encrypted_metadata:e,data:a}),d={hostname:o.awsLambda.saveTaskData.host,port:443,path:o.awsLambda.saveTaskData.path,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":t.byteLength(c)}},l=n.request(d,t=>{t.setEncoding("utf8"),t.on("data",()=>{}),t.on("end",r)});l.on("error",t=>{o.debug&&(console.log("ERROR:"),console.log(t)),i(t)}),l.write(c),l.end()}))}function i(e){return new Promise((function(a,r){const i=s.stringify({encrypted_metadata:e}),c={hostname:o.awsLambda.fetchLink.host,port:443,path:o.awsLambda.fetchLink.path,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":t.byteLength(i)}},d=n.request(c,t=>{t.setEncoding("utf8");var e="";t.on("data",(function(t){e+=t})),t.on("end",()=>a(e))});d.on("error",t=>{o.debug&&(console.log("ERROR:"),console.log(t)),r(t)}),d.write(i),d.end()}))}}).call(this,a(7).Buffer)},49:function(t){t.exports=JSON.parse('{"taskVersion":"1.0.0","taskName":"tnt_fu","debug":false,"awsLambda":{"saveTaskData":{"host":"de8cnjde61.execute-api.us-east-2.amazonaws.com","path":"/default/saveTaskData"},"fetchLink":{"host":"3pnzb6n9vf.execute-api.us-east-2.amazonaws.com","path":"/default/fetchLink"}}}')},53:function(t,e,a){t.exports=a(125)},65:function(t,e){},67:function(t,e){},80:function(t,e){}},[[53,1,2]]]);
//# sourceMappingURL=main.94999e9a.chunk.js.map